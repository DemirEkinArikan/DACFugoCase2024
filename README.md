# Revenue Prediction from In-Game User Data

This project is focused on predicting the total revenue that users will generate in their first 90 days, based on the first 15 days of their in-game behavior.


## Files Description

- **example_data/**: This directory contains example datasets (limited to the first 10k rows).
  - `users_train.csv`: User metadata including device information, country, and platform data.
  - `user_features_train.csv`: First 15 days of user in-game behavior including levels completed, ad revenue, and IAP revenue.
  - `targets_train.csv`: Total revenue generated by each user in the first 90 days (the target variable).
  - `users_test.csv`: User metadata including device information, country, and platform data for test.
  - `user_features_test.csv`: First 15 days of user in-game behavior including levels completed, ad revenue, and IAP revenue for test.
  
- **best_prediction.csv**: The best prediction results, containing two columns: `ID` (the user ID) and `TARGET` (the predicted day-90 revenue).
  
- **DAC24.ipynb**: Jupyter Notebook file containing the code to load the data, preprocess it, build models, and make predictions.
  
- **presentation.pptx**: A PowerPoint presentation providing a summary of the project.

## Data Description

The dataset consists of the following key features:
- **ID**: Unique ID for every installation of the game (User ID).
- **first_open_date**: Date of the first launch of the game.
- **first_open_timestamp**: Timestamp of the first launch of the game, in UTC timezone, Unix time in microseconds.
- **local_first_open_timestamp**: First open timestamp in local timezone of the user.
- **country**: Country of the user.
- **platform**: Platform of the user; Android or iOS.
- **device_category**: Category of the device; mobile or tablet.
- **device_brand**: Brand of the device.
- **device_model**: Model of the device.
- **has_ios_att_permission**: Whether the iOS user has given ATT permission (true or false), false for Android users.
- **ad_network**: Ad network the user has come from, null for organic users.
- **first_prediction**: Initial predicted value of the user (in USD).
- **RetentionD{i}**: Whether the user launched the game at i'th day (true or false).
- **LevelAdvancedCountD{i}**: Number of levels the user completed at i'th day.
- **Level_{i}_Duration**: The time it takes for the user to complete i'th level (null if the user hasnâ€™t completed i'th level).
- **AdRevenueD{i}**: Amount of ad revenue (in USD) the user generated at i'th day.
- **IAPRevenueD{i}**: Amount of IAP (in-app purchase) revenue the user generated at i'th day.
- **TARGET**: Total amount of revenue the user generated in their first 90 days (this is the target value to predict).

## Model

The `DAC24.ipynb` file is the core of the project. It contains all the necessary steps for data preprocessing, model training, evaluation, and prediction. Below are the key sections and their purpose:

1. **Data Loading**:
   - The notebook loads the training datasets (`users_train.csv`, `user_features_train.csv`, `targets_train.csv`) and the test datasets using `pandas`.
   
2. **Data Preprocessing**:
   - Preprocessing steps include:
     - **Handling Missing Values**: Missing values in columns such as level completion times or revenue are filled or removed as necessary.
     - **Feature Engineering**: This involves creating additional features based on user behavior, such as calculating total revenue over multiple days or level completion times.
     - **Scaling**: Both sequential (time-series) data and engineered features are scaled using `StandardScaler`.

3. **LSTM Model for Time-Series Data**:
   - An **LSTM (Long Short-Term Memory)** model is implemented to capture sequential patterns in user behavior over the first 15 days. This model can effectively handle time-series data by processing the sequential data points for each user.
   - The model uses:
     - **Bidirectional LSTM** layers to learn from past and future time steps.
     - **Dropout** layers to prevent overfitting.
     - **Batch Normalization** for stabilization during training.
     - A **Dense** output layer to predict the total revenue after 90 days.

4. **Train-Test Split**:
   - The notebook performs a train-test split, preserving the sequence of time-series data for each user. This ensures that the validation set accurately reflects unseen user behavior.

5. **Model Evaluation**:
   - The evaluation is performed using **Root Mean Square Error (RMSE)** on the validation set. The notebook includes a cross-validation step to ensure that the model generalizes well to unseen data.
   
6. **Model Optimization**:
   - The notebook optimizes the model using hyperparameters like batch size, learning rate (set to 0.00003), and dropout rates. The model is compiled using the Adam optimizer and MSE loss function.

7. **Predictions**:
   - After training, the model generates predictions on the test data (`users_test.csv` and `user_features_test.csv`), and the results are saved in the `best_prediction.csv` file for submission.

## Setup Instructions

1. Clone the repository and navigate to the project directory.
2. Install the required libraries.
3. To run the analysis, open the DAC24.ipynb file in Jupyter Notebook or Google Colab.
4. To make predictions on the test dataset, ensure the files are in place in the example_data folder and run the prediction cells in the notebook.

## Evaluation
The model is evaluated using RMSE (Root Mean Square Error). Lower RMSE indicates better predictive performance(assuming the model is not overfitting)
